<p>In caso serva ripristinare una cartella o una mail cancellata su un server imap Cyrus, non &egrave; sufficiente copiare l&#39;elemento nella cartella appropriata, ma occorre ricostruire l&#39;indice del demone.</p>
<p>La cartella di default dove sono memorizzate le email &egrave;:</p>
<p><strong>/var/spool/cyrus/mail/<em>a</em>/user/<em>nomeutente</em></strong></p>
<p>Dove <em>a</em>&nbsp;&egrave; l&#39;iniziale del nome utente, e <em>nomeutente</em> &egrave; ovviamente l&#39;utente imap.</p>
<p>Ripristinato il file o la cartella, per ricostruire l&#39;indice si usa <em>cyrreconstruct</em>, da lanciare come utente <em>cyrus</em>.</p>
<pre class="brush: bash;fontsize: 100; first-line: 1; ">su - cyrus -c "/usr/sbin/cyrreconstruct -rfx user/annamaria.rivetta"</pre>
<p>In questo caso non dobbiamo dare il path completo ma solo il percorso relativo al server. Il separatore, in questo caso <em>slash</em>, dipende dal parametro <em>unixhierarchysep</em>. Se impostato a 0, il separatore sar&agrave; il <em>punto</em>.</p>
<p>Se viene ripristinata una cartella che non contiene messaggi, ma solo sottocartelle, potrebbe essere ignorata dal comando. In questo caso basta creare un file con i comandi</p>
<p>
<pre class="brush: bash;fontsize: 100; first-line: 1; ">touch nomecartella/cyrus.header
chown cyrus:mail nomecartella/cyrus.header</pre>
e rilanciare <em>cyrreconstruct</em>.</p>