<p><span>Ora passiamo alla pratica, questa è la situazione:</span><br /><span>nel mio caso il computer ha, di fabbrica, due partizioni: la prima contenente il sistema di ripristino, mentre nella seconda c&#39;è il sistema operativo vero e proprio. Quando installiamo </span><span>Linux</span><span>, prima dobbiamo creare lo spazio necessario al nuovo ospite, ridimensionando la seconda partizione, per intenderci, quella in cui risiede </span><span>Windows 7</span><span>; dopodiché, installiamo nell&#39;</span><span>MBR</span><span> il boot loader, che in questo caso è </span><span>Grub 2</span><span>, il quale vedrà tre partizioni da avviare: la prima sarà quella per il ripristino Windows, la seconda quella di </span><span>Windows 7</span><span> e infine la terza sarà quella contenete </span><span>Ubuntu Linux</span><span>. Nel caso il computer in questione sia usato solo da noi, poco male, ma cosa succederebbe se nostra moglie o i nostri figli premessero involontariamente la voce sbagliata? Il risultato sarebbe funesto: verrebbe distrutta la partizione dedicata a </span><span>Linux</span><span> e noi perderemmo (quasi sicuramente) tutti i dati contenuti in quella parte dell&#39;hard disk.</span><br /><br /><span>E questa è la soluzione:</span><br /><span>bisogna nascondere il sistema di ripristino di </span><span>Windows</span><span> dal menu di </span><span>Grub</span><span> e, per farlo, dobbiamo sporcarci le mani con gli script di </span><span>Grub 2</span><span>.</span><br /><br /><span>1) apriamo un terminale da </span><span>Applicazioni -&gt; Accessori -&gt; Terminale</span><br /><br /><span>2) acquisiamo i permessi per poter operare da root:</span><br /><span>$ </span><span>sudo -s</span><span> [invio]</span><br /><span>password</span><span> [invio]</span><br /><br /><span>3) apriamo, con Gedit, il file </span><span>/boot/grub/grub.cfg</span><span>:</span><br /><br /><span># </span><span>gedit /boot/grub/grub.cfg</span><span> [invio]</span><br /><br /><span>4) cerchiamo in fondo al file il riferimento a </span><span>Windows</span><span>, lo troveremo tra le righe:</span><br /><br /><span>### BEGIN /etc/grub.d/30_os-prober ###</span><br /><br /><span>e</span><br /><br /><span>### END /etc/grub.d/30_os-prober ###</span><br /><br /><br /><span>e si presenterà all&#39;incirca in questo modo:</span><br /><br /><span>menuentry "Windows 7 (loader) (on /dev/sda1)" {</span><br /><span>insmod ntfs</span><br /><span>set root=&#39;(hd0,1)&#39;</span><br /><span>search --no-floppy --fs-uuid --set ac4e7aea4e7aad28</span><br /><span>chainloader +1</span><br /><span>}</span><br /><span>menuentry "Windows 7 (loader) (on /dev/sda2)" {</span><br /><span>insmod ntfs</span><br /><span>set root=&#39;(hd0,2)&#39;</span><br /><span>search --no-floppy --fs-uuid --set 48caa0edcaa0d888</span><br /><span>chainloader +1</span><br /><span>}</span><br /><span>anche se apparentemente le due entry sono simili, noi sappiamo benissimo che nella prima partizione risiede il sistema di ripristino, mentre nella seconda partizione c&#39;è il sistema operativo vero e proprio, cioè, quello che serve a noi. Quindi selezioniamo con il mouse tutta la parte di nostro interesse, cioè, quella che vogliamo compaia nel menu di </span><span>Grub</span><span>:</span><br /><br /><span>menuentry "Windows 7 (loader) (on /dev/sda2)" {</span><br /><span>insmod ntfs</span><br /><span>set root=&#39;(hd0,2)&#39;</span><br /><span>search --no-floppy --fs-uuid --set 48caa0edcaa0d888</span><br /><span>chainloader +1</span><br /><span>}</span><br /><br /><span>e copiamolo con la combianzione</span><span> [CTRL] + [C]</span><br /><br /><span>chiudiamo Gedit e dal solito terminale apriamo il file </span><span>/etc/grub.d/40_custom</span><span>:</span><br /><br /><span># </span><span>gedit /etc/grub.d/40_custom</span><span> [invio]</span><br /><br /><span>posizionamoci in fondo al file, incolliamo con la combinazione </span><span>[CTRL] + [V]</span><br /><span>e se non già presente, aggiungiamo EOF (end of file) in modo che il tutto assomigli a qualcosa del genere:</span><br /><br /><span>#!/bin/sh</span><br /><span>exec tail -n +3 $0</span><br /><span># This file provides an easy way to add custom menu entries. Simply type the</span><br /><span># menu entries you want to add after this comment. Be careful not to change</span><br /><span># the &#39;exec tail&#39; line above.</span><br /><br /><span>Adding Windows 7 to GRUB 2 menu</span><br /><span>menuentry "Windows 7 (loader) (on /dev/sda2)" {</span><br /><span>insmod ntfs</span><br /><span>set root=&#39;(hd0,2)&#39;</span><br /><span>search --no-floppy --fs-uuid --set 48caa0edcaa0d888</span><br /><span>chainloader +1</span><br /><span>}</span><br /><span>EOF </span><br /><br /><span>a questo punto non ci resta che salvare e chiudere Gedit.</span><br /><br /><span>Ora dobbiamo istruire </span><span>Grub</span><span> perché prenda in considerazione la voce contenuta nel nostro </span><span>40_custom</span><span>, piuttosto che quelle generate attualmente dallo script </span><span>30_os-prober</span><span>. Per fare ciò è sufficiente cambiare i permessi agli script interessati, in questo modo:</span><br /><br /><br /><span># </span><span>chmod -x /etc/grub.d/30_os-prober</span><span> [invio]</span><br /><br /><span># </span><span>chmod +x /etc/grub.d/40_custom</span><span> [invio]</span><br /><br /><span>infine dobbiamo ricordarci di aggiornare </span><span>Grub 2</span><span> in modo da rendere effettive le modifiche da noi richieste:</span><br /><span># </span><span>update-grub2</span><span> [invio]</span><br /><br /><span>e con questo abbiam finito.</span><br /><br /><span>Ovviamente, nel caso che per qualche motivo, foste interessati a far riapparire la voce relativa al ripristino di </span><span>Windows</span><span>, non dovrete far altro che invertire i permessi di esecuzione ai due file appena visti e far rileggere a </span><span>Grub</span><span> le nuove impostazioni:</span><br /><br /><span># </span><span>chmod +x /etc/grub.d/30_os-prober</span><span> [invio]</span><br /><span># </span><span>chmod -x /etc/grub.d/40_custom</span><span> [invio]</span><br /><span># </span><span>update-grub2</span><span> [invio]</span></p>
<p> </p>
<p> </p>
<p>SE NON PARTE IL SITEMA OPERATIVO AGGIUNGERE LA PRIMA VOCE DI WINDOWS 7 NEL FILE <span>/etc/grub.d/40_custom</span></p>